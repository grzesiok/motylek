-- liquibase formatted sql-- changeset liquibase:1 author:kasprzyg dbms:oracleCREATE SEQUENCE SEQ_JOB_FILE_ID;-- changeset liquibase:2 author:kasprzyg dbms:oracleCREATE SEQUENCE SEQ_JOB_LOG_ID;-- changeset liquibase:3 author:kasprzyg dbms:oracleCREATE SEQUENCE SEQ_JOB_MESSAGE_ID;-- changeset liquibase:4 author:kasprzyg dbms:oracleCREATE SEQUENCE SEQ_JOB_METADATA_ID;-- changeset liquibase:5 author:kasprzyg dbms:oracleCREATE TABLE JOB_TYPE (  JOB_TYPE_CODE VARCHAR2(5 BYTE),   JOB_TYPE_DESC VARCHAR2(255 BYTE)) tablespace ts_logging_data;CREATE UNIQUE INDEX JOB_TYPE_PK ON JOB_TYPE (JOB_TYPE_CODE) tablespace ts_logging_index;ALTER TABLE JOB_TYPE MODIFY (JOB_TYPE_CODE NOT NULL ENABLE);ALTER TABLE JOB_TYPE MODIFY (JOB_TYPE_DESC NOT NULL ENABLE);ALTER TABLE JOB_TYPE ADD CONSTRAINT JOB_TYPE_PK PRIMARY KEY (JOB_TYPE_CODE) USING INDEX JOB_TYPE_PK  ENABLE;Insert into JOB_TYPE (JOB_TYPE_CODE,JOB_TYPE_DESC) values ('BASIC','Simple job');-- changeset liquibase:6 author:kasprzyg dbms:oracleCREATE TABLE JOB_STATUS (  JOB_STATUS_CODE VARCHAR2(5 BYTE),   JOB_STATUS_DESC VARCHAR2(255 BYTE)) tablespace ts_logging_data;CREATE UNIQUE INDEX JOB_STATUS_PK ON JOB_STATUS (JOB_STATUS_CODE) tablespace ts_logging_index;ALTER TABLE JOB_STATUS MODIFY (JOB_STATUS_CODE NOT NULL ENABLE);ALTER TABLE JOB_STATUS MODIFY (JOB_STATUS_DESC NOT NULL ENABLE);ALTER TABLE JOB_STATUS ADD CONSTRAINT JOB_STATUS_PK PRIMARY KEY (JOB_STATUS_CODE) USING INDEX  ENABLE;Insert into JOB_STATUS (JOB_STATUS_CODE,JOB_STATUS_DESC) values ('UN','UNKNOWN');Insert into JOB_STATUS (JOB_STATUS_CODE,JOB_STATUS_DESC) values ('EXEC','EXECUTING');Insert into JOB_STATUS (JOB_STATUS_CODE,JOB_STATUS_DESC) values ('SU','SUCCESS');Insert into JOB_STATUS (JOB_STATUS_CODE,JOB_STATUS_DESC) values ('ERROR','ERROR');-- changeset liquibase:7 author:kasprzyg dbms:oracleCREATE TABLE JOB_MESSAGE_TYPE (  JOB_MESSAGE_TYPE_CODE VARCHAR2(5 BYTE),   JOB_MESSAGE_TYPE VARCHAR2(255 BYTE),   INCLUDE_STACKTRACE VARCHAR2(1 BYTE)) tablespace ts_logging_data;CREATE UNIQUE INDEX JOB_MESSAGE_TYPE_PK ON JOB_MESSAGE_TYPE (JOB_MESSAGE_TYPE_CODE) tablespace ts_logging_index;ALTER TABLE JOB_MESSAGE_TYPE MODIFY (JOB_MESSAGE_TYPE_CODE NOT NULL ENABLE);ALTER TABLE JOB_MESSAGE_TYPE MODIFY (JOB_MESSAGE_TYPE NOT NULL ENABLE);ALTER TABLE JOB_MESSAGE_TYPE ADD CONSTRAINT JOB_MESSAGE_TYPE_PK PRIMARY KEY (JOB_MESSAGE_TYPE_CODE) USING INDEX  ENABLE;ALTER TABLE JOB_MESSAGE_TYPE MODIFY (INCLUDE_STACKTRACE NOT NULL ENABLE);Insert into JOB_MESSAGE_TYPE (JOB_MESSAGE_TYPE_CODE,JOB_MESSAGE_TYPE,INCLUDE_STACKTRACE) values ('WARN','WARNING','N');Insert into JOB_MESSAGE_TYPE (JOB_MESSAGE_TYPE_CODE,JOB_MESSAGE_TYPE,INCLUDE_STACKTRACE) values ('DEBUG','DEBUG','N');Insert into JOB_MESSAGE_TYPE (JOB_MESSAGE_TYPE_CODE,JOB_MESSAGE_TYPE,INCLUDE_STACKTRACE) values ('INFO','INFORMATION','N');Insert into JOB_MESSAGE_TYPE (JOB_MESSAGE_TYPE_CODE,JOB_MESSAGE_TYPE,INCLUDE_STACKTRACE) values ('ERR','ERROR','Y');Insert into JOB_MESSAGE_TYPE (JOB_MESSAGE_TYPE_CODE,JOB_MESSAGE_TYPE,INCLUDE_STACKTRACE) values ('CERR','CRITICAL_ERROR','Y');-- changeset liquibase:8 author:kasprzyg dbms:oracleCREATE TABLE JOB_METADATA (  JOB_METADATA_ID NUMBER,   JOB_NAME VARCHAR2(255 BYTE),   JOB_DESC VARCHAR2(4000 BYTE),   JOB_TYPE_CODE VARCHAR2(5 BYTE)) tablespace ts_logging_data;CREATE UNIQUE INDEX JOB_EXEC_METADATA_PK ON JOB_METADATA (JOB_METADATA_ID) tablespace ts_logging_index;CREATE UNIQUE INDEX JOB_EXEC_METADATA_UK01 ON JOB_METADATA (JOB_NAME) tablespace ts_logging_index;ALTER TABLE JOB_METADATA MODIFY (JOB_NAME NOT NULL ENABLE);ALTER TABLE JOB_METADATA ADD CONSTRAINT JOB_EXEC_METADATA_PK PRIMARY KEY (JOB_METADATA_ID) USING INDEX  ENABLE;ALTER TABLE JOB_METADATA ADD CONSTRAINT JOB_EXEC_METADATA_UK01 UNIQUE (JOB_NAME) USING INDEX  ENABLE;ALTER TABLE JOB_METADATA MODIFY (JOB_DESC NOT NULL ENABLE);ALTER TABLE JOB_METADATA MODIFY (JOB_TYPE_CODE NOT NULL ENABLE);ALTER TABLE JOB_METADATA ADD CONSTRAINT JOB_METADATA_FK01 FOREIGN KEY (JOB_TYPE_CODE) REFERENCES JOB_TYPE (JOB_TYPE_CODE) ENABLE;-- changeset liquibase:9 author:kasprzyg dbms:oracleCREATE TABLE JOB_LOG (  JOB_LOG_ID NUMBER,   PARENT_JOB_LOG_ID NUMBER,   JOB_METADATA_ID NUMBER,   JOB_STATUS_CODE VARCHAR2(5 BYTE),   LOG_TIME TIMESTAMP (6) WITH LOCAL TIME ZONE,   START_TIME TIMESTAMP (6) WITH LOCAL TIME ZONE,   END_TIME TIMESTAMP (6) WITH LOCAL TIME ZONE,   DATABASE_NAME VARCHAR2(128 BYTE),   OS_USER VARCHAR2(128 BYTE),   SESSION_USER VARCHAR2(128 BYTE),   SESSION_ID NUMBER,   PLSQL_UNIT VARCHAR2(128 BYTE),   PLSQL_LINENO NUMBER,   PLSQL_OWNER VARCHAR2(128 BYTE)) tablespace ts_logging_data;CREATE UNIQUE INDEX JOB_LOG_PK ON JOB_LOG (JOB_LOG_ID) tablespace ts_logging_index;ALTER TABLE JOB_LOG MODIFY (JOB_LOG_ID NOT NULL ENABLE);ALTER TABLE JOB_LOG MODIFY (JOB_METADATA_ID NOT NULL ENABLE);ALTER TABLE JOB_LOG MODIFY (JOB_STATUS_CODE NOT NULL ENABLE);ALTER TABLE JOB_LOG MODIFY (LOG_TIME NOT NULL ENABLE);ALTER TABLE JOB_LOG MODIFY (START_TIME NOT NULL ENABLE);ALTER TABLE JOB_LOG ADD CONSTRAINT JOB_LOG_PK PRIMARY KEY (JOB_LOG_ID) USING INDEX  ENABLE;ALTER TABLE JOB_LOG MODIFY (DATABASE_NAME NOT NULL ENABLE);ALTER TABLE JOB_LOG MODIFY (OS_USER NOT NULL ENABLE);ALTER TABLE JOB_LOG MODIFY (SESSION_USER NOT NULL ENABLE);ALTER TABLE JOB_LOG MODIFY (SESSION_ID NOT NULL ENABLE);ALTER TABLE JOB_LOG ADD CONSTRAINT JOB_LOG_FK01 FOREIGN KEY (JOB_METADATA_ID) REFERENCES JOB_METADATA (JOB_METADATA_ID) ENABLE;ALTER TABLE JOB_LOG ADD CONSTRAINT JOB_LOG_FK02 FOREIGN KEY (JOB_STATUS_CODE) REFERENCES JOB_STATUS (JOB_STATUS_CODE) ENABLE;-- changeset liquibase:10 author:kasprzyg dbms:oracleCREATE TABLE JOB_FILE(  JOB_FILE_ID NUMBER,   JOB_LOG_ID NUMBER,   RECORD_COUNT NUMBER,   ERROR_COUNT NUMBER,   INSERT_COUNT NUMBER,   UPDATE_COUNT NUMBER,   DELETE_COUNT NUMBER) tablespace ts_logging_data;CREATE UNIQUE INDEX JOB_FILE_PK ON JOB_FILE (JOB_FILE_ID) tablespace ts_logging_index;ALTER TABLE JOB_FILE MODIFY (JOB_FILE_ID NOT NULL ENABLE);ALTER TABLE JOB_FILE MODIFY (JOB_LOG_ID NOT NULL ENABLE);ALTER TABLE JOB_FILE ADD CONSTRAINT JOB_FILE_PK PRIMARY KEY (JOB_FILE_ID) USING INDEX JOB_FILE_PK  ENABLE;ALTER TABLE JOB_FILE MODIFY (RECORD_COUNT NOT NULL ENABLE);ALTER TABLE JOB_FILE MODIFY (ERROR_COUNT NOT NULL ENABLE);ALTER TABLE JOB_FILE MODIFY (INSERT_COUNT NOT NULL ENABLE);ALTER TABLE JOB_FILE MODIFY (UPDATE_COUNT NOT NULL ENABLE);ALTER TABLE JOB_FILE MODIFY (DELETE_COUNT NOT NULL ENABLE);ALTER TABLE JOB_FILE ADD CONSTRAINT JOB_FILE_FK01 FOREIGN KEY (JOB_LOG_ID) REFERENCES JOB_LOG (JOB_LOG_ID) ENABLE;-- changeset liquibase:11 author:kasprzyg dbms:oracleCREATE TABLE JOB_MESSAGE (  JOB_MESSAGE_ID NUMBER,   JOB_LOG_ID NUMBER,   MESSAGE VARCHAR2(4000 BYTE),   ERROR_STACK VARCHAR2(4000 BYTE),   ERROR_BACKTRACE VARCHAR2(4000 BYTE),   LOG_TIME TIMESTAMP (6),   JOB_MESSAGE_TYPE_CODE VARCHAR2(5 BYTE)) tablespace ts_logging_data;CREATE UNIQUE INDEX JOB_MESSAGE_PK ON JOB_MESSAGE (JOB_MESSAGE_ID) tablespace ts_logging_index;ALTER TABLE JOB_MESSAGE MODIFY (JOB_MESSAGE_ID NOT NULL ENABLE);ALTER TABLE JOB_MESSAGE MODIFY (JOB_LOG_ID NOT NULL ENABLE);ALTER TABLE JOB_MESSAGE ADD CONSTRAINT JOB_MESSAGE_PK PRIMARY KEY (JOB_MESSAGE_ID) USING INDEX  ENABLE;ALTER TABLE JOB_MESSAGE MODIFY (LOG_TIME NOT NULL ENABLE);ALTER TABLE JOB_MESSAGE MODIFY (JOB_MESSAGE_TYPE_CODE NOT NULL ENABLE);ALTER TABLE JOB_MESSAGE ADD CONSTRAINT JOB_MESSAGE_FK01 FOREIGN KEY (JOB_MESSAGE_TYPE_CODE) REFERENCES JOB_MESSAGE_TYPE (JOB_MESSAGE_TYPE_CODE) ENABLE;ALTER TABLE JOB_MESSAGE ADD CONSTRAINT JOB_MESSAGE_FK02 FOREIGN KEY (JOB_LOG_ID) REFERENCES JOB_LOG (JOB_LOG_ID) ENABLE;-- changeset liquibase:12 author:kasprzyg dbms:oracleALTER TABLE JOB_LOG ADD (COMMENTS VARCHAR2(4000));-- changeset liquibase:13 author:kasprzyg dbms:oracleALTER TABLE JOB_LOG DROP COLUMN JOB_METADATA_ID;ALTER TABLE JOB_LOG ADD (JOB_NAME VARCHAR2(255));-- changeset liquibase:14 author:kasprzyg dbms:oracleDROP SEQUENCE SEQ_JOB_METADATA_ID;DROP TABLE JOB_METADATA;DROP TABLE JOB_TYPE;-- changeset liquibase:15 author:kasprzyg dbms:oracleALTER TABLE JOB_LOG DROP COLUMN COMMENTS;-- changeset liquibase:16 author:kasprzyg dbms:oracleCREATE INDEX JOB_LOG_FK01 ON JOB_LOG (PARENT_JOB_LOG_ID) tablespace ts_logging_index;CREATE INDEX JOB_LOG_FK02 ON JOB_LOG (JOB_STATUS_CODE) tablespace ts_logging_index;ALTER TABLE JOB_LOG ADD CONSTRAINT JOB_LOG_FK01 FOREIGN KEY (PARENT_JOB_LOG_ID) REFERENCES JOB_LOG (JOB_LOG_ID) ENABLE;